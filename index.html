<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nuestra Historia Infinita</title>

<style>

    /* üì± Ajustes para celular */
@media (max-width: 600px) {

    body {
        padding: 15px;
    }

    h1 {
        font-size: 28px;
        text-align: center;
    }

    button {
        width: 85%;
        font-size: 18px;
        padding: 12px;
    }

    canvas {
        width: 95%;
        height: auto;
    }

}

body{
    margin:0;
    font-family: 'Segoe UI', sans-serif;
    background: linear-gradient(to bottom, #0f2027, #203a43, #2c5364);
    color:white;
    text-align:center;
    overflow-x:hidden;
}

/* Fondo estrellas */
.stars {
    position: fixed;
    width: 100%;
    height: 100%;
    background: url('https://www.transparenttextures.com/patterns/stardust.png');
    animation: moveStars 120s linear infinite;
    z-index:-1;
}
@keyframes moveStars {
    from {background-position: 0 0;}
    to {background-position: 10000px 5000px;}
}

/* Secciones */
.section{
    min-height:100vh;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    padding:40px;
    opacity:0;
    transform: translateY(20px);
    transition: all 0.8s ease;
}
.section.active{
    opacity:1;
    transform: translateY(0);
}

.card{
    background: rgba(255,255,255,0.08);
    padding:30px;
    border-radius:25px;
    backdrop-filter: blur(15px);
    max-width:700px;
    margin-bottom:30px;
    box-shadow: 0 0 25px rgba(255,255,255,0.1);
}

/* ‚ú® NUEVO: Glow al pasar mouse */
.card:hover{
    box-shadow:0 0 40px rgba(255,255,255,0.4);
    transform:scale(1.02);
    transition:0.4s;
}

.locked{ opacity:0.6; }

button{
    padding:12px 28px;
    margin-top:20px;
    border:none;
    border-radius:40px;
    background: linear-gradient(45deg, #ffffff, #ffd6f6);
    color:#2c5364;
    font-weight:bold;
    cursor:pointer;
    transition:0.3s;
}
button:hover{ transform:scale(1.05); }

/* ‚ú® NUEVO: efecto presi√≥n bot√≥n */
button:active{
    transform:scale(0.95);
}

#diasJuntos{
    position:fixed;
    top:15px;
    left:20px;
    font-size:14px;
    background:rgba(255,255,255,0.1);
    padding:10px 18px;
    border-radius:30px;
    backdrop-filter: blur(10px);
}

.hidden{ display:none; }

.frasePrincipal{
    font-size:1.6em;
    margin-bottom:20px;
    text-shadow:0 0 15px rgba(255,255,255,0.6);
}

/* ‚ú® NUEVO: corazones flotantes */
.corazonFlotante{
    position:fixed;
    font-size:20px;
    animation: flotar 3s linear forwards;
    pointer-events:none;
    z-index:999;
}

@keyframes flotar{
    0%{ transform:translateY(0); opacity:1;}
    100%{ transform:translateY(-200px); opacity:0;}
}

.carousel{
    position:relative;
    background:rgba(0,0,0,0.3);
    border-radius:20px;
    padding:10px;
}

.carousel img{
    width:100%;
    max-height:350px;
    object-fit:contain;
    border-radius:20px;
    transition:opacity 0.8s ease;
}

.puntos{ margin-top:10px; }
.punto{
    display:inline-block;
    width:10px;
    height:10px;
    border-radius:50%;
    background:rgba(255,255,255,0.4);
    margin:5px;
}
.punto.activo{ background:white; }

.mensajeBox{
    margin:30px 0;
    padding:20px;
    background:rgba(255,192,203,0.15);
    border-radius:20px;
    box-shadow:0 0 20px rgba(255,192,203,0.3);
}

/* üëá ESTO HACE QUE RESPETE LOS SALTOS DE L√çNEA */
.mensajeBox p{
    white-space: pre-line;
}


    


.juegoContainer{ margin-top:20px; }

.juego-grid{
    display:grid;
    grid-template-columns:repeat(3,1fr);
    gap:10px;
    margin-top:15px;
}

.cuadro{
    background:rgba(255,255,255,0.1);
    height:60px;
    border-radius:10px;
    cursor:pointer;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:22px;
    transition:0.3s;
    animation: brillo 2s infinite;
}
.cuadro:hover{ background:rgba(255,255,255,0.2); }

@keyframes brillo{
    0%{ box-shadow:0 0 5px rgba(255,192,203,0.3);}
    50%{ box-shadow:0 0 20px rgba(255,192,203,0.8);}
    100%{ box-shadow:0 0 5px rgba(255,192,203,0.3);}
}

.ganador{
    animation: ganar 1s infinite alternate;
}
@keyframes ganar{
    from{ box-shadow:0 0 10px pink;}
    to{ box-shadow:0 0 40px hotpink;}
}

.fraseSecreta{
    margin-top:20px;
    font-size:1.2em;
    color:#ffd6f6;
    text-shadow:0 0 10px pink;
}


/* VIDEO */
.videoBox{
    margin-top:30px;
    padding:20px;
    background:rgba(255,255,255,0.08);
    border-radius:20px;
    backdrop-filter: blur(10px);
    box-shadow:0 0 25px rgba(255,255,255,0.15);
}

.videoRomantico{
    width:100%;
    max-width:600px;
    border-radius:15px;
    margin-top:15px;
    box-shadow:0 0 20px rgba(255,192,203,0.4);
    transition:0.4s;
}

.videoRomantico:hover{
    transform:scale(1.02);
}

.spotifyBox{
    margin:25px 0;
    padding:15px;
    background:rgba(255,255,255,0.08);
    border-radius:20px;
    backdrop-filter:blur(10px);
    box-shadow:0 0 25px rgba(255,255,255,0.15);
}

/* ‚ú® Animaci√≥n galer√≠a */
#galeriaFinal{
    animation: aparecerGaleria 1s ease forwards;
}

@keyframes aparecerGaleria{
    from{
        opacity:0;
        transform: translateY(20px);
    }
    to{
        opacity:1;
        transform: translateY(0);
    }
}

#contenedorGaleria img{
    transition:0.4s;
}
#contenedorGaleria{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(100px,1fr));
    gap:12px;
    max-height:300px;
    overflow-y:auto;
    padding:10px;
}

#contenedorGaleria img{
    width:100%;
    height:90px;
    object-fit:cover;
    border-radius:10px;
    box-shadow:0 0 8px rgba(255,192,203,0.4);
    transition:0.3s;
}

#contenedorGaleria img:hover{
    transform:scale(1.08);
    box-shadow:0 0 20px hotpink;
}


canvas {
    touch-action: none; /* Bloquea gestos del navegador para que no interfieran al dibujar */
    max-width: 100%;    /* Evita que se salga de la pantalla */
    height: auto;       /* Mantiene la proporci√≥n */
}

</style>
</head>

<body>

<div class="stars"></div>
<div id="diasJuntos"></div>

<div class="section active" id="inicio">
    <h1>üê¢ Nuestra Historia ‚ôæÔ∏è‚ú®</h1>
    <h2>Solo es el comienzo mi amorcita hermosa.</h2>
    <button onclick="mostrarCapitulos()">Entrar</button>
</div>

<div class="section hidden" id="capitulos">
    <div class="card">
        <h1>Cap√≠tulo 1 üå∏</h1>
        <h2>14 de Febrero</h2>
        <button onclick="abrirCap1()">Entrar</button>
    </div>

    <div class="card locked">
        <h1>Cap√≠tulo 2 üîí</h1>
        <h2>20 de Febrero</h2>
        <div id="contadorDesbloqueo"></div>
        <button id="btnCap2" onclick="abrirCap2()">Entrar</button>
    </div>
</div>

<div class="section hidden" id="contenidoCap1">
    <div class="card">

        <div class="frasePrincipal">
            Porque cada momento contigo es HERMOSO ‚ú®üê¢
        </div>

        <div class="spotifyBox">
<iframe data-testid="embed-iframe"
style="border-radius:12px"
src="https://open.spotify.com/embed/track/5Ejw3lC6Srj8VK4fHgTZAi?utm_source=generator&theme=0"
width="100%"
height="352"
frameBorder="0"
allowfullscreen=""
allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
loading="lazy">
</iframe>
</div>

        <!-- ‚ú® NUEVO mensaje secreto doble click -->
        <div id="mensajeSecretoExtra" class="hidden" style="margin-top:15px; color:#ffb6f9;">
        Eres lo mejor que me ha pasado üíñ
        </div>

        
        <!-- =============================== -->
        <!--   üì∏ AQUI VAN TUS FOTOS        -->
        <!-- Guarda tus im√°genes en la MISMA carpeta -->
        <!-- Nombres actuales configurados: -->
        <!-- foto1.jpg, foto2.jpg, foto3.jpg -->
        <!-- Si quieres m√°s fotos agr√©galas en -->
        <!-- const fotos=[...] en el script -->
        <!-- =============================== -->

        <div class="carousel">
            <img id="fotoCarrusel" src="foto1.jpg">
            <div class="puntos" id="puntos"></div>
        </div>

        <div class="mensajeBox">
            <h3>üíå Un pedacito de lo que siento por ti</h3>
            <p id="mensajeMaquina"></p>
        </div>

        <!-- VIDEO SENTIMENTAL -->
        
        <!-- =============================== -->
        <!--   üé¨ AQUI VA TU VIDEO          -->
        <!-- Guarda el video en la misma carpeta -->
        <!-- Nombre configurado: nuestro_video.mp4 -->
        <!-- =============================== -->

        <div class="videoBox">
            <h3>üé¨ Nuestro momento</h3>
            <video controls class="videoRomantico">
                <source src="nuestro_video.mp4" type="video/mp4">
            </video>
        </div>

        <button onclick="mostrarJuego()">üéÆ Jugar</button>

        <div id="juegoArea" class="hidden juegoContainer">
            <h3>Encuentra el coraz√≥n üíñ</h3>
            <div class="juego-grid">
                <div class="cuadro" onclick="revisar(this)"></div>
                <div class="cuadro" onclick="revisar(this)"></div>
                <div class="cuadro" onclick="revisar(this)"></div>
                <div class="cuadro" onclick="revisar(this)"></div>
                <div class="cuadro" onclick="revisar(this)"></div>
                <div class="cuadro" onclick="revisar(this)"></div>
            </div>
            <div id="fraseSecreta" class="fraseSecreta hidden">
                Si encontraste el coraz√≥n‚Ä¶ es porque siempre has tenido el m√≠o üíñ
            </div>
        </div>

        </div>

<!-- üé® MINI JUEGO DIBUJAR HISTORIAS -->
<!-- üé® MINI JUEGO DIBUJAR HISTORIAS PRO -->
<button onclick="mostrarDibujo()">üé® Dibujar nuestra historia</button>

<div id="juegoDibujo" class="hidden juegoContainer">

    <h3 id="retoTexto">Dibuja: Nuestra primera cita üíï</h3>

    <!-- üé® PALETA DE COLORES -->
    <div style="margin:15px 0;">
        <input type="color" id="colorPicker" value="#ff4da6">
        <label style="margin-left:10px;">Grosor:</label>
        <input type="range" id="grosorPincel" min="1" max="10" value="3">
        <button onclick="activarGoma()" style="margin-left:10px;">üßΩ Goma</button>

    </div>

    <canvas id="canvasDibujo" width="400" height="300"
        style="background:white; border-radius:15px; cursor:crosshair;">
    </canvas>

    <br>

    <button onclick="cambiarReto()">Siguiente historia ‚ú®</button>
    <button onclick="limpiarCanvas()">üßΩ Limpiar</button>
    <button onclick="descargarDibujo()">üíæ Descargar dibujo</button>

    <div id="mensajeFinalDibujo" class="fraseSecreta hidden">
        Tus dibujos ahora son recuerdos hermosos ‚ôæÔ∏èüíñ
    </div>

  <div id="galeriaFinal" class="hidden" style="margin-top:20px;">
    <h3>üñº Nuestra Galer√≠a de Recuerdos</h3>

    <div id="contenedorGaleria"></div>

    <button onclick="descargarTodos()" style="margin-top:15px;">
        üíæ Descargar todos los recuerdos
    </button>
</div>




</div>

</div>

<button onclick="volver()">Volver</button>

    </div>
</div>

<div class="section hidden" id="contenidoCap2">
    <div class="card">
        <h1>Cap√≠tulo 2 ‚ú®</h1>
        <p>AQU√ç VA MI MENSAJE DEL 20</p>
        <button onclick="volver()">Volver</button>
    </div>
</div>



<script>

function cambiarSeccion(actual,nueva){
    document.getElementById(actual).classList.remove("active");
    setTimeout(()=>{
        document.getElementById(actual).classList.add("hidden");
        document.getElementById(nueva).classList.remove("hidden");
        setTimeout(()=>{document.getElementById(nueva).classList.add("active");},50);
    },400);
}

function mostrarCapitulos(){ cambiarSeccion("inicio","capitulos"); }

function abrirCap1(){ 
    cambiarSeccion("capitulos","contenidoCap1"); 
   
    setTimeout(escribirMaquina,500);
    lanzarCorazones(); // ‚ú® a√±adido
}

function volver(){
    
    cambiarSeccion("contenidoCap1","capitulos");
}

const fechaObjetivo=new Date("February 20, 2026 00:00:00").getTime();
const fechaInicio=new Date("February 20, 2025 00:00:00").getTime();

function abrirCap2(){
    if(new Date().getTime()>=fechaObjetivo){
        cambiarSeccion("capitulos","contenidoCap2");
    }
}

setInterval(function(){
    const ahora=new Date().getTime();
    const diferencia=ahora-fechaInicio;
    const dias=Math.floor(diferencia/(1000*60*60*24));
    const horas=Math.floor((diferencia%(1000*60*60*24))/(1000*60*60));
    const minutos=Math.floor((diferencia%(1000*60*60))/(1000*60));
    const segundos=Math.floor((diferencia%(1000*60))/1000);
    document.getElementById("diasJuntos").innerHTML=
    "üê¢ "+dias+"d "+horas+"h "+minutos+"m "+segundos+" juntos ‚ôæÔ∏è";
},1000);

setInterval(function(){
    const ahora=new Date().getTime();
    const distancia=fechaObjetivo-ahora;

    if(distancia>0){
        const dias=Math.floor(distancia/(1000*60*60*24));
        const horas=Math.floor((distancia%(1000*60*60*24))/(1000*60*60));
        const minutos=Math.floor((distancia%(1000*60*60))/(1000*60));
        const segundos=Math.floor((distancia%(1000*60))/1000);
        document.getElementById("contadorDesbloqueo").innerHTML=
        "Se desbloquea en: "+dias+"d "+horas+"h "+minutos+"m "+segundos+"s ‚è≥";
        document.getElementById("btnCap2").disabled=true;
    }else{
        document.getElementById("contadorDesbloqueo").innerHTML=
        "Cap√≠tulo desbloqueado üíñ";
        document.getElementById("btnCap2").disabled=false;
    }
},1000);

const texto = `Feliz 14 de febrero amor de mi alma hermosa üíóüéâ

Hello mi ni√±ita hermosa sabes yo desde el inicio supe que no solo eras una historia sino mi libro entero ü•πüíó

A√∫n recuerdo el anterior 14 de febrero, estaba full nervioso porque quer√≠a decirte lo que sent√≠a por ti‚Ä¶ y desde que te conoc√≠ fue algo raro, algo incre√≠ble üòçüíó

Fue como si el destino me dijera: ella, ella üíó‚ú®  
Y despu√©s te fui conociendo y puedo asegurarte que eres el amor de mi alma.

C√≥mo olvidar las historias, las risas, el primer beso, cada nucita que te echo, las cartas que me has regalado ü•πüíó  
¬øC√≥mo no agradecerle a la vida si estoy con mi peque√±ita hermosa? üíóüê¢

Eres la ni√±ita m√°s:

Hermosa  
Bonita  
Estupenda  
Guap√≠sima  
Lindota  
Perfecta  
√önica  
Inteligente  
Divina  

Y podr√≠a seguir m√°s y m√°s üòçüíó

Si me dieran la opci√≥n de volver a nacer ir√≠a corriendo a buscarte una y otra vez üíóü•π

¬øPor qu√©?

Porque t√∫ eres mi felicidad entera.  
Contigo me siento especial, el hombre m√°s afortunado üíó

Gracias por todo amor de mi alma ü•πüíó‚ú®  
Por este amor tan bonito que tenemos.

Yo s√≠ quiero despertar a tu lado siempre.  
Yo s√≠ quiero ser el causante de tus sonrisas.  
Yo quiero hacerte la mujer m√°s feliz üíû

Mientras yo exista nunca te faltar√° nada porque siempre tendr√°s un loquito que:

‚Ä¢ TE AME POR SIEMPRE  
‚Ä¢ TE APOYE SIEMPRE  
‚Ä¢ EST√â CONTIGO INCLUSO EN LOS D√çAS MALOS  
‚Ä¢ TE DEJE SER T√ö üíó  

Viajar√≠a incluso a otro planeta por ti üíóüåô  
Y cr√©eme‚Ä¶ siempre juntos ‚ôæÔ∏èüíñ

Recuerda que nada es para siempre‚Ä¶  
solo nosotros üíóüê¢üê¢üíó

Te amo infinitamente y m√°s all√° üíó‚ú®

Feliz 14 de febrero.  
Este es el primero de infinitos ü•πüíó

Siempre ser√© tuyo üíóüê¢

Muackkkkk  
Muackkkkk  
Muackkkkk üòöüíó‚ôæÔ∏è`;

let i=0;
function escribirMaquina(){
    const el=document.getElementById("mensajeMaquina");
    el.innerHTML="";
    i=0;
    const intervalo=setInterval(()=>{
        if(i<texto.length){
            el.innerHTML+=texto.charAt(i);
            i++;
        }else{
            clearInterval(intervalo);
        }
    },35);
}

const fotos=["foto1.jpg","foto2.jpg","foto3.jpg"];
let indice=0;
const img=document.getElementById("fotoCarrusel");
const puntosDiv=document.getElementById("puntos");

fotos.forEach((_,i)=>{
    const punto=document.createElement("span");
    punto.classList.add("punto");
    if(i===0) punto.classList.add("activo");
    puntosDiv.appendChild(punto);
});

function actualizarCarrusel(){
    img.style.opacity=0;
    setTimeout(()=>{
        img.src=fotos[indice];
        img.style.opacity=1;
        document.querySelectorAll(".punto").forEach(p=>p.classList.remove("activo"));
        document.querySelectorAll(".punto")[indice].classList.add("activo");
    },400);
}
setInterval(()=>{
    indice=(indice+1)%fotos.length;
    actualizarCarrusel();
},5000);

let posicionCorazon=Math.floor(Math.random()*6);

function mostrarJuego(){
    document.getElementById("juegoArea").classList.remove("hidden");
}

function revisar(el){
    const cuadros=document.querySelectorAll(".cuadro");
    const index=Array.from(cuadros).indexOf(el);
    if(index===posicionCorazon){
        el.innerHTML="üíñ";
        el.classList.add("ganador");
        document.getElementById("fraseSecreta").classList.remove("hidden");
        confeti(); // ‚ú® a√±adido
    } else{
        el.innerHTML="‚ùå";
    }
}

/* ‚ú® NUEVAS FUNCIONES */

function lanzarCorazones(){
    for(let i=0;i<20;i++){
        const corazon=document.createElement("div");
        corazon.innerHTML="üíñ";
        corazon.classList.add("corazonFlotante");
        corazon.style.left=Math.random()*100+"vw";
        corazon.style.top="80vh";
        document.body.appendChild(corazon);
        setTimeout(()=>{corazon.remove();},3000);
    }
}

function confeti(){
    for(let i=0;i<30;i++){
        const part=document.createElement("div");
        part.innerHTML="‚ú®";
        part.style.position="fixed";
        part.style.left=Math.random()*100+"vw";
        part.style.top=Math.random()*100+"vh";
        part.style.fontSize="15px";
        part.style.animation="flotar 2s linear forwards";
        document.body.appendChild(part);
        setTimeout(()=>{part.remove();},2000);
    }
}

document.querySelector(".frasePrincipal").addEventListener("dblclick",()=>{
    document.getElementById("mensajeSecretoExtra").classList.toggle("hidden");
});

/* ‚ú® estrellas fugaces */
setInterval(()=>{
    const estrella=document.createElement("div");
    estrella.innerHTML="üå†";
    estrella.style.position="fixed";
    estrella.style.left=Math.random()*100+"vw";
    estrella.style.top="10vh";
    estrella.style.fontSize="20px";
    estrella.style.animation="flotar 2s linear forwards";
    document.body.appendChild(estrella);
    setTimeout(()=>{estrella.remove();},2000);
},15000);


/* ========================= */
/* MINI JUEGO DIBUJAR ULTRA PRO */
/* ========================= */

const canvas = document.getElementById("canvasDibujo");
const ctx = canvas.getContext("2d");

let dibujando = false;
let colorActual = document.getElementById("colorPicker").value;
let grosorActual = document.getElementById("grosorPincel").value;
let modoGoma = false;



document.getElementById("colorPicker").addEventListener("input", function(){
    colorActual = this.value;
    modoGoma = false;
});

document.getElementById("grosorPincel").addEventListener("input", function(){
    grosorActual = this.value;
});

function activarGoma(){
    modoGoma = true;
}

canvas.addEventListener("mousedown", () => dibujando = true);

canvas.addEventListener("mouseup", () => {
    dibujando = false;
    ctx.beginPath();
    guardarDibujoAutomatico();
});

// ==========================================
// üöÄ SISTEMA DE DIBUJO UNIVERSAL (PC + M√ìVIL)
// ==========================================

// Funci√≥n para obtener coordenadas exactas sin importar el dispositivo o el zoom
function getCoordinates(e) {
    const rect = canvas.getBoundingClientRect();
    let clientX, clientY;

    // Detectar si es toque o mouse
    if (e.touches && e.touches[0]) {
        clientX = e.touches[0].clientX;
        clientY = e.touches[0].clientY;
    } else {
        clientX = e.clientX;
        clientY = e.clientY;
    }

    // Calibraci√≥n de escala para que el trazo est√© SIEMPRE bajo el puntero/dedo
    const scaleX = canvas.width / rect.width;
    const scaleY = canvas.height / rect.height;

    return {
        x: (clientX - rect.left) * scaleX,
        y: (clientY - rect.top) * scaleY
    };
}

function iniciarDibujo(e) {
    if (e.type === 'touchstart') e.preventDefault(); 
    dibujando = true;
    const pos = getCoordinates(e);
    ctx.beginPath();
    ctx.moveTo(pos.x, pos.y);
}

function moverPincel(e) {
    if (!dibujando) return;
    if (e.type === 'touchmove') e.preventDefault(); 

    const pos = getCoordinates(e);

    ctx.lineWidth = grosorActual;
    ctx.lineCap = "round";
    ctx.lineJoin = "round";

    if(modoGoma){
        ctx.globalCompositeOperation = "destination-out";
    } else {
        ctx.globalCompositeOperation = "source-over";
        ctx.strokeStyle = colorActual;
    }

    ctx.lineTo(pos.x, pos.y);
    ctx.stroke();
    
    // Suavizado de trazo
    ctx.beginPath();
    ctx.moveTo(pos.x, pos.y);
}

function detenerDibujo() {
    if (dibujando) {
        dibujando = false;
        ctx.beginPath();
        guardarDibujoAutomatico();
    }
}

// ASIGNACI√ìN DE EVENTOS (PC)
canvas.addEventListener("mousedown", iniciarDibujo);
canvas.addEventListener("mousemove", moverPincel);
canvas.addEventListener("mouseup", detenerDibujo);
canvas.addEventListener("mouseleave", detenerDibujo);

// ASIGNACI√ìN DE EVENTOS (CELULAR)
canvas.addEventListener("touchstart", iniciarDibujo, { passive: false });
canvas.addEventListener("touchmove", moverPincel, { passive: false });
canvas.addEventListener("touchend", detenerDibujo, { passive: false });

function dibujar(e){
    if(!dibujando) return;

    const rect = canvas.getBoundingClientRect();
    ctx.lineWidth = grosorActual;
    ctx.lineCap = "round";

    if(modoGoma){
        ctx.globalCompositeOperation = "destination-out";
    } else {
        ctx.globalCompositeOperation = "source-over";
        ctx.strokeStyle = colorActual;
    }

    ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
    ctx.stroke();
    ctx.beginPath();
    ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top);
}

function limpiarCanvas(){
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.beginPath();
    guardarDibujoAutomatico();
}

function mostrarDibujo(){
    document.getElementById("juegoDibujo").classList.remove("hidden");
}

/* üé® Retos */
const retos = [
    "Nuestra proxima cita üíï",
    "Nuestro primer abrazo ü´Ç",
    "Un viaje juntos ‚úàÔ∏è",
    "C√≥mo nos ves en 5 a√±os üè°",
    "Nuestro futuro con minis loquitos üë∂üê¢"
];

let indiceReto = 0;

function cambiarReto(){

    guardarDibujoAutomatico();

    indiceReto++;

    if(indiceReto < retos.length){

        document.getElementById("retoTexto").innerText = 
        "Dibuja: " + retos[indiceReto];

        cargarDibujoGuardado();

    } else {

        document.getElementById("mensajeFinalDibujo")
        .classList.remove("hidden");

        mostrarGaleria();
    }
}






/* üíæ Descargar dibujo */
function descargarDibujo(){
    const link = document.createElement("a");
    link.download = "Nuestro_dibujo_" + indiceReto + ".png";
    link.href = canvas.toDataURL();
    link.click();
}

/* üñº GALER√çA FINAL */
/* ========================= */
/* SISTEMA ULTRA PRO FINAL */
/* ========================= */

let dibujosGuardados = JSON.parse(localStorage.getItem("galeriaAmor")) || {};

function guardarDibujoAutomatico(){
    dibujosGuardados[indiceReto] = canvas.toDataURL();
    localStorage.setItem("galeriaAmor", JSON.stringify(dibujosGuardados));
}

function cargarDibujoGuardado(){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    if(dibujosGuardados[indiceReto]){
        const img = new Image();
        img.src = dibujosGuardados[indiceReto];
        img.onload = function(){
            ctx.drawImage(img,0,0);
        };
    }
}

/* üñº GALER√çA FINAL */

function mostrarGaleria(){

    const galeria = document.getElementById("galeriaFinal");
    const contenedor = document.getElementById("contenedorGaleria");

    contenedor.innerHTML = "";

    for(let key in dibujosGuardados){

        const img = document.createElement("img");
        img.src = dibujosGuardados[key];
        img.style.width="100%";
        img.style.borderRadius="10px";
        img.style.boxShadow="0 0 10px pink";
        img.style.cursor="pointer";

        img.onclick = function(){
            indiceReto = parseInt(key);
            cargarDibujoGuardado();
            document.getElementById("juegoDibujo")
            .scrollIntoView({behavior:"smooth"});
        };

        contenedor.appendChild(img);
    }

    galeria.classList.remove("hidden");
    lluviaFinal();
}

/* üíæ Descargar todos */

function descargarTodos(){

    for(let key in dibujosGuardados){

        const link = document.createElement("a");
        link.download = "Recuerdo_" + key + ".png";
        link.href = dibujosGuardados[key];
        link.click();
    }
}

/* üéâ Animaci√≥n final */

function lluviaFinal(){

    for(let i=0;i<40;i++){
        const part = document.createElement("div");
        part.innerHTML="üíñ";
        part.style.position="fixed";
        part.style.left=Math.random()*100+"vw";
        part.style.top="-20px";
        part.style.fontSize="20px";
        part.style.animation="caer 3s linear forwards";
        document.body.appendChild(part);

        setTimeout(()=>{part.remove();},3000);
    }
}









</script>

</body>
</html>
